<div class="container my-4">
  <a class="text-decoration-none" href="/">Â« Back to Dashboard</a>

  <div class="d-flex align-items-center mt-3 flex-wrap gap-3">
    <div>
      <label class="form-label fw-semibold">Rounds per Team</label>
      <input type="number" class="form-control" [(ngModel)]="rounds" min="1" (ngModelChange)="updateMatchesRequired()">
    </div>
    <div>
      <label class="form-label fw-semibold">Teams</label>
      <div class="form-control bg-light">{{ teamsCount() }}</div>
    </div>
    <div>
      <label class="form-label fw-semibold">Total Matches Required (Estimated, maybe not correct)</label>
      <div class="form-control bg-light">{{ matchesRequired() }}</div>
    </div>
  </div>

  <hr>

  <h5 class="fw-semibold">Day Settings</h5>
  <div class="row g-3">
    <div class="col-md-4">
      <label class="form-label">First Match Start</label>
      <input type="datetime-local" class="form-control" [(ngModel)]="firstMatchStartLocal">
    </div>
    <div class="col-md-3">
      <label class="form-label">Cycle Time (minutes)</label>
      <input type="number" class="form-control" [(ngModel)]="cycleTimeMinutes" min="1">
      <div class="form-text">Used as matchDuration for all matches.</div>
    </div>
  </div>

  <hr>

  <h5 class="fw-semibold">Break Blocks (TimeBlocks)</h5>
  <div class="mb-3">
    <button class="btn btn-outline-secondary btn-sm" (click)="addBreakBlock()">
      Add Break Block
    </button>
  </div>

  <div *ngFor="let block of breakBlocks; let i = index" class="border rounded p-3 mb-3">
    <div class="d-flex justify-content-between">
      <div class="h6 mb-0">{{ block.name || 'Break' }}</div>
      <button class="btn btn-sm btn-secondary" (click)="removeBreakBlock(i)">Remove</button>
    </div>
    <div class="row g-3 mt-1">
      <div class="col-md-4">
        <label class="form-label">Label</label>
        <input type="text" class="form-control" [(ngModel)]="block.name" placeholder="Lunch Break">
      </div>
      <div class="col-md-4">
        <label class="form-label">Start</label>
        <input type="datetime-local" class="form-control" [(ngModel)]="block.startTimeLocal">
      </div>
      <div class="col-md-3">
        <label class="form-label">Duration (minutes)</label>
        <input type="number" class="form-control" [(ngModel)]="block.durationMinutes" min="1">
      </div>
    </div>
  </div>

  <div class="d-flex gap-2 mt-3">
    <button class="btn btn-primary" [disabled]="running()" (click)="runMatchMaker()">
      {{ running() ? 'Running...' : 'Run Matchmaker' }}
    </button>
  </div>

  <div class="mt-3" *ngIf="successMsg() as msg">
    <div class="alert alert-success" role="alert">{{ msg }}</div>
    <a class="btn btn-outline-primary btn-sm" href="/schedule">View Schedule</a>
  </div>

  <div class="mt-3" *ngIf="errorMsg() as msg">
    <div class="alert alert-danger" role="alert">{{ msg }}</div>
  </div>
</div>
